<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Penguin Project</title>
<style>
  :root { --bg:#0d0d0d; --row:#1a1a1a; --hover:#2a2a2a; --accent:#f1cad8; --txt:#eaeaea; }
  html,body {margin:0;height:100%;background:transparent;font-family:Arial,sans-serif;color:var(--txt);}
  .wrap{position:fixed;top:50%;left:40px;transform:translateY(-50%);}
  .panel{width:300px;height:420px;background:var(--bg);border-radius:6px;overflow:hidden;box-shadow:0 0 15px rgba(0,0,0,.6);display:flex;flex-direction:column;}
  .banner{height:120px;background:url('hello-kitty.png') center/cover;}
  .list{flex:1;overflow:hidden;position:relative;}
  .row{height:32px;line-height:32px;padding:0 14px;border-bottom:1px solid #000;display:flex;justify-content:space-between;align-items:center;}
  .row.active{background:var(--accent);color:#000;font-weight:600;}
  .highlight{position:absolute;left:0;width:100%;height:32px;background:var(--accent);z-index:0;transition:top .2s ease;}
  .bottombar{background:#111;padding:4px 8px;font-size:11px;display:flex;justify-content:space-between;}
  .checkbox::after{content:"[ ]";}
  .checkbox.active::after{content:"[x]";}
  .slider{flex:1;margin-left:10px;height:4px;background:#444;position:relative;}
  .slider-thumb{width:8px;height:8px;background:#fff;position:absolute;top:-2px;}
</style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <div class="banner"></div>
      <div class="list" id="menuList"></div>
      <div class="highlight" id="highlight"></div>
      <div class="bottombar"><span>credit: penguin</span><span>lala&lt;3</span></div>
    </div>
  </div>

<script>
  let menu=[], current="main", stack=[], selected=0;
  const el={list:document.getElementById("menuList"),highlight:document.getElementById("highlight")};

  function render(items){
    menu=items; el.list.innerHTML="";
    items.forEach((item,i)=>{
      const row=document.createElement("div");
      row.className="row"+(i===selected?" active":"");
      row.dataset.id=item.id; row.dataset.type=item.type;
      let label=document.createElement("span"); label.textContent=item.label;
      row.appendChild(label);

      if(item.type==="checkbox"){ row.classList.add("checkbox"); if(item.value) row.classList.add("active"); }
      if(item.type==="slider"){ let s=document.createElement("div"); s.className="slider";
        let thumb=document.createElement("div"); thumb.className="slider-thumb";
        thumb.style.left=((item.value-item.min)/(item.max-item.min))*100+"%";
        s.appendChild(thumb); row.appendChild(s);
      }
      el.list.appendChild(row);
    });
    updateHighlight();
  }

  function updateHighlight(){ el.highlight.style.top=(selected*32)+"px"; }

  window.addEventListener("message",ev=>{
    const d=ev.data||{};
    if(d.action==="menu" && d.payload){ render(d.payload.items); }
    if(d.action==="nav" && d.payload){
      if(d.payload.type==="up" && selected>0){selected--;render(menu);}
      if(d.payload.type==="down" && selected<menu.length-1){selected++;render(menu);}
      if(d.payload.type==="enter"){ let item=menu[selected]; if(item.type==="category"){ stack.push({menu,selected}); render(item.children); selected=0; } else { parent.postMessage({action:item.type,id:item.id},"*"); } }
      if(d.payload.type==="back"){ if(stack.length>0){ let st=stack.pop(); render(st.menu); selected=st.selected; } }
    }
  });
</script>
</body>
</html>
